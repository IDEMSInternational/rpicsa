% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/start_rains.R
\name{start_rains}
\alias{start_rains}
\title{Start of the Rains}
\usage{
start_rains(
  data,
  date_time,
  station = NULL,
  year = NULL,
  rain = NULL,
  threshold = 0.85,
  doy = NULL,
  start_day = 1,
  end_day = 366,
  s_start_month = 1,
  drop = TRUE,
  output = c("doy", "date", "status"),
  total_rainfall_over_days = 1,
  total_rainfall_comparison = c("amount", "proportion", "evaporation"),
  amount_rain = 20,
  prob_rain_day = 0.8,
  evaporation_variable = NULL,
  fraction = 0.5,
  number_rain_days = FALSE,
  min_rain_days = 1,
  rain_day_interval = 2,
  dry_spell = FALSE,
  spell_interval = 21,
  spell_max_dry_days = 9,
  dry_period = FALSE,
  period_interval = 45,
  max_rain = 40,
  period_max_dry_days = 30,
  data_book = NULL
)
}
\arguments{
\item{data}{\code{character(1)} Name of the data frame in the \code{data_book}.}

\item{date_time}{\code{character(1)} Name of the date (Date or POSIXct) column in \code{data}.}

\item{station}{\code{character(1)} Name of the station column, if multiple stations are present. Default \code{NULL}.}

\item{year}{\code{character(1)} Name of the year column. If \code{NULL}, it will be created from \code{date_time}.}

\item{rain}{\code{character(1)} Name of the rainfall column (mm) to evaluate.}

\item{threshold}{\code{numeric(1)} Minimum rainfall on a single day to count as “rain.” Default \code{0.85} mm.}

\item{doy}{\code{character(1)} Name of the day‐of‐year column. If \code{NULL}, it will be created from \code{date_time}.}

\item{start_day}{\code{integer(1)} Earliest day of year (1–366) to consider. Default \code{1}.}

\item{end_day}{\code{integer(1)} Latest day of year (1–366) to consider. Default \code{366}.}

\item{s_start_month}{\code{integer(1)} Month (1–12) to treat as the start of the “year” when creating \code{year} or \code{doy}. Default \code{NULL} (assumes January).}

\item{drop}{\code{logical(1)} If \code{TRUE}, drop years with no valid start‐rain calculation. Default \code{TRUE}.}

\item{output}{\code{character} Which outputs to produce: one or more of \code{"doy"}, \code{"date"}, \code{"status"}. Default all three.}

\item{total_rainfall_over_days}{\code{integer(1)} Number of days over which to total rainfall for the “total rainfall” definition. Default \code{1}.}

\item{total_rainfall_comparison}{\code{character} Method for multi‐day definition: \code{"amount"}, \code{"proportion"}, or \code{"evaporation"}. Default \code{"amount"}.}

\item{amount_rain}{\code{numeric(1)} If \code{total_rainfall_comparison="amount"}, the total rainfall (mm) threshold. Default \code{20}.}

\item{prob_rain_day}{\code{numeric(1)} If \code{total_rainfall_comparison="proportion"}, the quantile (0–1) of the rolling total to use. Default \code{0.8}.}

\item{evaporation_variable}{\code{character(1)} Name of evaporation (mm) column, if using \code{"evaporation"}. Default \code{NULL}.}

\item{fraction}{\code{numeric(1)} Multiplier (0–1) applied to evaporation values when \code{total_rainfall_comparison="evaporation"}. Default \code{0.5}.}

\item{number_rain_days}{\code{logical(1)} If \code{TRUE}, define start by minimum rainy days in an interval. Default \code{FALSE}.}

\item{min_rain_days}{\code{integer(1)} Minimum count of rainy days if \code{number_rain_days=TRUE}. Default \code{1}.}

\item{rain_day_interval}{\code{integer(1)} Interval length (days) for \code{number_rain_days}. Default \code{2}.}

\item{dry_spell}{\code{logical(1)} If \code{TRUE}, define start by a maximum dry‐spell length. Default \code{FALSE}.}

\item{spell_interval}{\code{integer(1)} Interval length (days) for the dry‐spell test. Default \code{21}.}

\item{spell_max_dry_days}{\code{integer(1)} Maximum consecutive dry days if \code{dry_spell=TRUE}. Default \code{9}.}

\item{dry_period}{\code{logical(1)} If \code{TRUE}, define start by combining max rainfall and max dry days in a period. Default \code{FALSE}.}

\item{period_interval}{\code{integer(1)} Interval length (days) for \code{dry_period}. Default \code{45}.}

\item{max_rain}{\code{numeric(1)} Maximum total rainfall (mm) allowed in \code{period_interval} if \code{dry_period=TRUE}. Default \code{40}.}

\item{period_max_dry_days}{\code{integer(1)} Maximum dry days if \code{dry_period=TRUE}. Default \code{30}.}

\item{data_book}{A \code{DataBook} object to use. If \code{NULL}, a new one is created. Default \code{NULL}.}
}
\value{
Invisibly returns the used \code{data_book}.  The side effect is that a new
linked data frame (e.g.\ \code{<data>_by_<station>_<year>}) is created with columns
\code{start_rain}, \code{start_rain_date}, and/or \code{start_rain_status}.
}
\description{
Identify the first day, date, and/or status marking the start of the rainy season
according to a variety of definitions (single‐day threshold, total rainfall over
days, proportion, spell length, etc.).
}
\examples{
library(databook)
data_book <- DataBook$new()
daily_data <- rpicsa::daily_niger \%>\%
  dplyr::filter(year <= 1950) \%>\%
  dplyr::filter(year > 1945) \%>\%
  dplyr::mutate(year = as.numeric(year)) \%>\%
  dplyr::filter(station_name == "Agades")
data_book$import_data(list(daily_data = daily_data))

daily_data <- data_book$get_data_frame("daily_data")

suppressWarnings(start_rains(data = "daily_data",
                             date_time = "date",
                             station = "station_name",
                             year = "year",
                             rain = "rain",
                             start_day = 121,
                             end_day = 300,
                             output = c("doy", "date", "status"),
                             data_book = data_book))
daily_data_by_station_name_year <- data_book$get_data_frame("daily_data_by_station_name_year.rds")
}
